import{u as U,s as A}from"./index-Dwd-OiAp.js";import{c as P,e as n,f as r,h as t,t as l,u as V,i as y,F as E,g as D,r as h,B as Y,n as L,C as X,y as $,A as M,D as K,q as tt,z as J,l as z}from"./vendor-BomGrhGO.js";import"./supabase-DoogjvA8.js";const et={class:"space-y-6"},st={class:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6"},ot={class:"bg-gradient-to-r from-blue-500 to-blue-600 text-white rounded-lg p-6"},lt={class:"flex items-center justify-between"},at={class:"text-3xl font-bold"},nt={class:"bg-gradient-to-r from-green-500 to-green-600 text-white rounded-lg p-6"},rt={class:"flex items-center justify-between"},it={class:"text-3xl font-bold"},dt={class:"bg-gradient-to-r from-purple-500 to-purple-600 text-white rounded-lg p-6"},ct={class:"flex items-center justify-between"},ut={class:"text-3xl font-bold"},mt={class:"bg-gradient-to-r from-yellow-500 to-yellow-600 text-white rounded-lg p-6"},xt={class:"flex items-center justify-between"},pt={class:"text-2xl font-bold"},gt={class:"grid grid-cols-1 lg:grid-cols-2 gap-6"},vt={class:"card"},bt={class:"space-y-3"},yt={class:"font-medium"},ft={class:"text-sm text-gray-500"},_t={class:"text-right"},ht={class:"font-bold text-green-600"},wt={class:"text-xs text-gray-500"},kt={key:0,class:"text-center py-8 text-gray-500"},$t={class:"card"},Ct={class:"space-y-3"},Pt={class:"font-medium"},Vt={class:"text-sm text-gray-500"},Et={class:"text-right"},Dt={class:"font-bold text-blue-600"},Nt={key:0,class:"text-center py-8 text-gray-500"},At={class:"card"},Mt={class:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4"},jt={class:"flex items-center space-x-3"},It=["src","alt"],Ot={class:"font-medium text-red-900"},Tt={class:"text-sm text-red-600"},St={key:0,class:"col-span-full text-center py-8 text-gray-500"},zt={__name:"AdminDashboard",setup(T){const x=U(),_=P(()=>{const i={};return x.pedidos.forEach(e=>{var w;const a=((w=e.producto)==null?void 0:w.nombre)||"Desconocido";i[a]||(i[a]={cantidad:0,totalValor:0}),i[a].cantidad+=e.cantidad,i[a].totalValor+=e.total}),Object.entries(i).map(([e,a])=>{const w=x.productos.find(C=>C.nombre===e);return{nombre:e,cantidad:a.cantidad,stock:w?w.stock:"N/A",totalValor:a.totalValor}}).sort((e,a)=>a.totalValor-e.totalValor)}),v=P(()=>{const i={};return x.pedidos.forEach(e=>{var w;const a=((w=e.vendedor)==null?void 0:w.nombre)||"Desconocido";i[a]||(i[a]={cantidad:0,totalValor:0}),i[a].cantidad++,i[a].totalValor+=e.total}),Object.entries(i).map(([e,a])=>({nombre:e,cantidad:a.cantidad,totalValor:a.totalValor})).sort((e,a)=>a.totalValor-e.totalValor)}),b=P(()=>x.productos.filter(i=>i.stock<=5)),c=i=>typeof i!="number"?"$0":i.toLocaleString("es-CO",{style:"currency",currency:"COP",minimumFractionDigits:0,maximumFractionDigits:0});return(i,e)=>(r(),n("div",et,[e[14]||(e[14]=t("h3",{class:"text-2xl font-bold text-gray-900"},"Dashboard de EstadÃ­sticas",-1)),t("div",st,[t("div",ot,[t("div",lt,[t("div",null,[e[0]||(e[0]=t("p",{class:"text-blue-100 text-sm"},"Total Productos",-1)),t("p",at,l(V(x).productos.length),1)]),e[1]||(e[1]=t("div",{class:"text-4xl opacity-80"},"ðŸ“¦",-1))])]),t("div",nt,[t("div",rt,[t("div",null,[e[2]||(e[2]=t("p",{class:"text-green-100 text-sm"},"Stock Total",-1)),t("p",it,l(V(x).totalStock),1)]),e[3]||(e[3]=t("div",{class:"text-4xl opacity-80"},"ðŸ“Š",-1))])]),t("div",dt,[t("div",ct,[t("div",null,[e[4]||(e[4]=t("p",{class:"text-purple-100 text-sm"},"Total Pedidos",-1)),t("p",ut,l(V(x).pedidos.length),1)]),e[5]||(e[5]=t("div",{class:"text-4xl opacity-80"},"ðŸ›’",-1))])]),t("div",mt,[t("div",xt,[t("div",null,[e[6]||(e[6]=t("p",{class:"text-yellow-100 text-sm"},"Ventas Totales",-1)),t("p",pt,l(c(V(x).totalVentas)),1)]),e[7]||(e[7]=t("div",{class:"text-4xl opacity-80"},"ðŸ’°",-1))])])]),t("div",gt,[t("div",vt,[e[9]||(e[9]=t("h4",{class:"text-lg font-semibold mb-4"},"ðŸ“ˆ Ventas por Producto",-1)),t("div",bt,[(r(!0),n(E,null,D(_.value,a=>(r(),n("div",{key:a.nombre,class:"flex items-center justify-between p-3 bg-gray-50 rounded-lg"},[t("div",null,[t("p",yt,l(a.nombre),1),t("p",ft,l(a.cantidad)+" unidades vendidas",1)]),t("div",_t,[t("p",ht,l(c(a.totalValor)),1),t("p",wt,"Stock: "+l(a.stock),1)])]))),128)),_.value.length===0?(r(),n("div",kt,[...e[8]||(e[8]=[t("div",{class:"text-4xl mb-2"},"ðŸ“Š",-1),t("p",null,"No hay ventas registradas",-1)])])):y("",!0)])]),t("div",$t,[e[11]||(e[11]=t("h4",{class:"text-lg font-semibold mb-4"},"ðŸ‘¥ Ventas por Vendedor",-1)),t("div",Ct,[(r(!0),n(E,null,D(v.value,a=>(r(),n("div",{key:a.nombre,class:"flex items-center justify-between p-3 bg-gray-50 rounded-lg"},[t("div",null,[t("p",Pt,l(a.nombre),1),t("p",Vt,l(a.cantidad)+" pedidos",1)]),t("div",Et,[t("p",Dt,l(c(a.totalValor)),1)])]))),128)),v.value.length===0?(r(),n("div",Nt,[...e[10]||(e[10]=[t("div",{class:"text-4xl mb-2"},"ðŸ‘¥",-1),t("p",null,"No hay ventas por vendedor",-1)])])):y("",!0)])])]),t("div",At,[e[13]||(e[13]=t("h4",{class:"text-lg font-semibold mb-4"},"âš ï¸ Productos con Bajo Stock",-1)),t("div",Mt,[(r(!0),n(E,null,D(b.value,a=>(r(),n("div",{key:a.id,class:"p-4 bg-red-50 border border-red-200 rounded-lg"},[t("div",jt,[t("img",{src:a.imagen,alt:a.nombre,class:"w-12 h-12 object-cover rounded-lg"},null,8,It),t("div",null,[t("p",Ot,l(a.nombre),1),t("p",Tt,"Stock: "+l(a.stock)+" unidades",1)])])]))),128)),b.value.length===0?(r(),n("div",St,[...e[12]||(e[12]=[t("div",{class:"text-4xl mb-2"},"âœ…",-1),t("p",null,"Todos los productos tienen stock suficiente",-1)])])):y("",!0)])])]))}},Lt={class:"space-y-6"},Ut={class:"flex items-center justify-between"},Ft={class:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-6"},Zt={class:"aspect-square mb-4 overflow-hidden rounded-lg bg-gray-100"},qt=["src","alt"],Gt={class:"space-y-2"},Wt={class:"font-semibold text-lg text-gray-900"},Bt={class:"flex justify-center mt-3"},Ht={class:"mt-4"},Rt=["onClick"],Qt={key:0,class:"text-center py-12"},Jt={key:1,class:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4"},Yt={class:"bg-white rounded-lg max-w-md w-full max-h-[90vh] overflow-y-auto"},Xt={class:"p-6"},Kt={class:"flex items-center justify-between mb-4"},te={class:"text-xl font-semibold"},ee={class:"grid grid-cols-2 gap-4"},se={key:2,class:"mt-2"},oe=["src"],le={class:"flex space-x-3 pt-4"},ae=["disabled"],ne={key:0},re={key:1},ie={__name:"ProductManagement",setup(T){const x=U(),_=h(!1),v=h(!1),b=h(!1),c=h(""),i=h(null),e=Y({id:null,nombre:"",stock:0,costo_publico:16e3,costo_mayorista:13e3,imagen:""}),a=()=>{_.value=!1,v.value=!1,w()},w=()=>{e.id=null,e.nombre="",e.stock=0,e.costo_publico=16e3,e.costo_mayorista=13e3,e.imagen="",c.value="",i.value=null},C=g=>{g.target.src="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMzAwIiBoZWlnaHQ9IjMwMCIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KICA8cmVjdCB3aWR0aD0iMzAwIiBoZWlnaHQ9IjMwMCIgZmlsbD0iI2Y3ZjdmNyIvPgogIDx0ZXh0IHg9IjUwJSIgeT0iNTAlIiBmb250LWZhbWlseT0iQXJpYWwsIHNhbnMtc2VyaWYiIGZvbnQtc2l6ZT0iMTgiIGZpbGw9IiM5OTk5OTkiIHRleHQtYW5jaG9yPSJtaWRkbGUiIGR5PSIuM2VtIj5TaW4gSW1hZ2VuPC90ZXh0Pgo8L3N2Zz4K"},j=g=>{const o=g.target.files[0];if(o){i.value=o;const m=new FileReader;m.onload=N=>{c.value=N.target.result},m.readAsDataURL(o)}},f=g=>{e.id=g.id,e.nombre=g.nombre,e.stock=g.stock,e.costo_publico=g.costo_publico,e.costo_mayorista=g.costo_mayorista,e.imagen=g.imagen,c.value=g.imagen,v.value=!0},d=async()=>{try{b.value=!0;let g=e.imagen;if(i.value){const m=i.value.name.split(".").pop(),I=`public/${`${Date.now()}.${m}`}`,{error:S}=await A.storage.from("imagenes_productos").upload(I,i.value);if(S)throw S;const{data:u}=A.storage.from("imagenes_productos").getPublicUrl(I);g=u.publicUrl}const o={nombre:e.nombre,stock:e.stock,costo_publico:e.costo_publico,costo_mayorista:e.costo_mayorista,imagen:g};if(v.value){const{error:m}=await A.from("productos").update(o).eq("id",e.id);if(m)throw m;alert("Producto actualizado exitosamente")}else{const{error:m}=await A.from("productos").insert([o]);if(m)throw m;alert("Producto agregado exitosamente")}await x.loadProductos(),a()}catch(g){console.error("Error guardando producto:",g),alert("Error al guardar producto: "+g.message)}finally{b.value=!1}};return(g,o)=>(r(),n("div",Lt,[t("div",Ut,[o[6]||(o[6]=t("h3",{class:"text-2xl font-bold text-gray-900"},"GestiÃ³n de Productos",-1)),t("button",{onClick:o[0]||(o[0]=m=>_.value=!0),class:"btn-primary"}," âž• Agregar Producto ")]),t("div",Ft,[(r(!0),n(E,null,D(V(x).productos,m=>(r(),n("div",{key:m.id,class:"card group hover:scale-105 transition-transform duration-200"},[t("div",Zt,[t("img",{src:m.imagen,alt:m.nombre,class:"w-full h-full object-cover group-hover:scale-110 transition-transform duration-300",onError:C},null,40,qt)]),t("div",Gt,[t("h3",Wt,l(m.nombre),1),t("div",Bt,[t("span",{class:L(["px-4 py-2 rounded-full text-sm font-bold shadow-md",m.stock>10?"bg-green-500 text-white":m.stock>0?"bg-yellow-500 text-white":"bg-red-500 text-white"])}," ðŸ“¦ "+l(m.stock)+" unidades ",3)])]),t("div",Ht,[t("button",{onClick:N=>f(m),class:"w-full btn-secondary text-sm"}," âœï¸ Editar Producto ",8,Rt)])]))),128))]),V(x).productos.length===0?(r(),n("div",Qt,[o[7]||(o[7]=t("div",{class:"text-gray-400 text-6xl mb-4"},"ðŸ“¦",-1)),o[8]||(o[8]=t("p",{class:"text-gray-500 text-lg"},"No hay productos registrados",-1)),t("button",{onClick:o[1]||(o[1]=m=>_.value=!0),class:"btn-primary mt-4"}," Agregar Primer Producto ")])):y("",!0),_.value||v.value?(r(),n("div",Jt,[t("div",Yt,[t("div",Xt,[t("div",Kt,[t("h4",te,l(v.value?"Editar Producto":"Agregar Producto"),1),t("button",{onClick:a,class:"text-gray-400 hover:text-gray-600"}," âœ• ")]),t("form",{onSubmit:X(d,["prevent"]),class:"space-y-4"},[t("div",null,[o[9]||(o[9]=t("label",{class:"block text-sm font-medium text-gray-700 mb-2"}," Nombre del Producto * ",-1)),$(t("input",{"onUpdate:modelValue":o[2]||(o[2]=m=>e.nombre=m),type:"text",required:"",class:"input-field",placeholder:"Nombre del producto"},null,512),[[M,e.nombre]])]),t("div",null,[o[10]||(o[10]=t("label",{class:"block text-sm font-medium text-gray-700 mb-2"}," Stock Inicial * ",-1)),$(t("input",{"onUpdate:modelValue":o[3]||(o[3]=m=>e.stock=m),type:"number",min:"0",required:"",class:"input-field",placeholder:"Cantidad en stock"},null,512),[[M,e.stock,void 0,{number:!0}]])]),t("div",ee,[t("div",null,[o[11]||(o[11]=t("label",{class:"block text-sm font-medium text-gray-700 mb-2"}," Precio PÃºblico * ",-1)),$(t("input",{"onUpdate:modelValue":o[4]||(o[4]=m=>e.costo_publico=m),type:"number",min:"0",step:"100",required:"",class:"input-field",placeholder:"16000"},null,512),[[M,e.costo_publico,void 0,{number:!0}]])]),t("div",null,[o[12]||(o[12]=t("label",{class:"block text-sm font-medium text-gray-700 mb-2"}," Precio Mayorista * ",-1)),$(t("input",{"onUpdate:modelValue":o[5]||(o[5]=m=>e.costo_mayorista=m),type:"number",min:"0",step:"100",required:"",class:"input-field",placeholder:"13000"},null,512),[[M,e.costo_mayorista,void 0,{number:!0}]])])]),t("div",null,[o[13]||(o[13]=t("label",{class:"block text-sm font-medium text-gray-700 mb-2"}," Imagen del Producto * ",-1)),v.value?(r(),n("input",{key:1,onChange:j,type:"file",accept:"image/*",class:"input-field"},null,32)):(r(),n("input",{key:0,onChange:j,type:"file",accept:"image/*",required:"",class:"input-field"},null,32)),c.value?(r(),n("div",se,[t("img",{src:c.value,alt:"Preview",class:"w-32 h-32 object-cover rounded-lg"},null,8,oe)])):y("",!0)]),t("div",le,[t("button",{type:"submit",disabled:b.value,class:"flex-1 btn-primary disabled:opacity-50"},[b.value?(r(),n("span",ne,"Guardando...")):(r(),n("span",re,l(v.value?"Actualizar":"Agregar")+" Producto",1))],8,ae),t("button",{type:"button",onClick:a,class:"flex-1 btn-secondary"}," Cancelar ")])],32)])])])):y("",!0)]))}},de={class:"space-y-6"},ce={class:"flex items-center justify-between"},ue={class:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6"},me={class:"flex items-start justify-between"},xe={class:"flex-1"},pe={class:"text-lg font-semibold text-gray-900"},ge={class:"text-gray-600"},ve={key:0,class:"text-gray-500 text-sm"},be={class:"mt-3 space-y-1"},ye={class:"flex justify-between text-sm"},fe={class:"font-medium"},_e={class:"flex justify-between text-sm"},he={class:"font-medium text-green-600"},we=["onClick"],ke={key:0,class:"text-center py-12"},$e={key:1,class:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4"},Ce={class:"bg-white rounded-lg max-w-md w-full"},Pe={class:"p-6"},Ve={class:"flex items-center justify-between mb-4"},Ee={class:"text-xl font-semibold"},De={class:"flex space-x-3 pt-4"},Ne=["disabled"],Ae={key:0},Me={__name:"VendorManagement",setup(T){const x=U(),_=h(!1),v=h(!1),b=h(!1),c=Y({id:null,nombre:"",email:"",telefono:""}),i=()=>{_.value=!1,v.value=!1,e()},e=()=>{c.id=null,c.nombre="",c.email="",c.telefono=""},a=f=>{c.id=f.id,c.nombre=f.nombre,c.email=f.email,c.telefono=f.telefono||"",v.value=!0},w=async()=>{try{b.value=!0;const f={nombre:c.nombre,email:c.email,telefono:c.telefono||null};if(v.value){const{error:d}=await A.from("vendedores").update(f).eq("id",c.id);if(d)throw d;alert("Vendedor actualizado exitosamente")}else{const{error:d}=await A.from("vendedores").insert([f]);if(d)throw d;alert("Vendedor agregado exitosamente")}await x.loadVendedores(),i()}catch(f){console.error("Error guardando vendedor:",f),alert("Error al guardar vendedor: "+f.message)}finally{b.value=!1}},C=f=>{const d=x.pedidos.filter(g=>g.vendedor_id===f);return{pedidos:d.length,ventas:d.reduce((g,o)=>g+o.total,0)}},j=f=>typeof f!="number"?"$0":f.toLocaleString("es-CO",{style:"currency",currency:"COP",minimumFractionDigits:0,maximumFractionDigits:0});return(f,d)=>{const g=K('else"');return r(),n("div",de,[t("div",ce,[d[5]||(d[5]=t("h3",{class:"text-2xl font-bold text-gray-900"},"GestiÃ³n de Vendedores",-1)),t("button",{onClick:d[0]||(d[0]=o=>_.value=!0),class:"btn-primary"}," âž• Agregar Vendedor ")]),t("div",ue,[(r(!0),n(E,null,D(V(x).vendedores,o=>(r(),n("div",{key:o.id,class:"card"},[t("div",me,[t("div",xe,[t("h4",pe,l(o.nombre),1),t("p",ge,l(o.email),1),o.telefono?(r(),n("p",ve,l(o.telefono),1)):y("",!0),t("div",be,[t("div",ye,[d[6]||(d[6]=t("span",{class:"text-gray-500"},"Pedidos:",-1)),t("span",fe,l(C(o.id).pedidos),1)]),t("div",_e,[d[7]||(d[7]=t("span",{class:"text-gray-500"},"Ventas:",-1)),t("span",he,l(j(C(o.id).ventas)),1)])])]),t("div",null,[t("button",{onClick:m=>a(o),class:"btn-secondary text-sm px-3 py-1",title:"Editar"}," âœï¸ Editar ",8,we)])])]))),128))]),V(x).vendedores.length===0?(r(),n("div",ke,[d[8]||(d[8]=t("div",{class:"text-gray-400 text-6xl mb-4"},"ðŸ‘¥",-1)),d[9]||(d[9]=t("p",{class:"text-gray-500 text-lg"},"No hay vendedores registrados",-1)),t("button",{onClick:d[1]||(d[1]=o=>_.value=!0),class:"btn-primary mt-4"}," Agregar Primer Vendedor ")])):y("",!0),_.value||v.value?(r(),n("div",$e,[t("div",Ce,[t("div",Pe,[t("div",Ve,[t("h4",Ee,l(v.value?"Editar Vendedor":"Agregar Vendedor"),1),t("button",{onClick:i,class:"text-gray-400 hover:text-gray-600"}," âœ• ")]),t("form",{onSubmit:X(w,["prevent"]),class:"space-y-4"},[t("div",null,[d[10]||(d[10]=t("label",{class:"block text-sm font-medium text-gray-700 mb-2"}," Nombre Completo * ",-1)),$(t("input",{"onUpdate:modelValue":d[2]||(d[2]=o=>c.nombre=o),type:"text",required:"",class:"input-field",placeholder:"Nombre completo del vendedor"},null,512),[[M,c.nombre]])]),t("div",null,[d[11]||(d[11]=t("label",{class:"block text-sm font-medium text-gray-700 mb-2"}," Email * ",-1)),$(t("input",{"onUpdate:modelValue":d[3]||(d[3]=o=>c.email=o),type:"email",required:"",class:"input-field",placeholder:"email@ejemplo.com"},null,512),[[M,c.email]])]),t("div",null,[d[12]||(d[12]=t("label",{class:"block text-sm font-medium text-gray-700 mb-2"}," TelÃ©fono ",-1)),$(t("input",{"onUpdate:modelValue":d[4]||(d[4]=o=>c.telefono=o),type:"tel",class:"input-field",placeholder:"NÃºmero de telÃ©fono"},null,512),[[M,c.telefono]])]),t("div",De,[t("button",{type:"submit",disabled:b.value,class:"flex-1 btn-primary disabled:opacity-50"},[b.value?(r(),n("span",Ae,"Guardando...")):y("",!0),$((r(),n("span",null,[tt(l(v.value?"Actualizar":"Agregar")+" Vendedor",1)])),[[g]])],8,Ne),t("button",{type:"button",onClick:i,class:"flex-1 btn-secondary"}," Cancelar ")])],32)])])])):y("",!0)])}}},je={class:"space-y-6"},Ie={class:"flex items-center justify-between"},Oe={class:"flex space-x-3"},Te=["value"],Se={class:"grid grid-cols-1 md:grid-cols-4 gap-4"},ze={class:"bg-blue-50 p-4 rounded-lg"},Le={class:"text-2xl font-bold text-blue-600"},Ue={class:"bg-green-50 p-4 rounded-lg"},Fe={class:"text-2xl font-bold text-green-600"},Ze={class:"bg-yellow-50 p-4 rounded-lg"},qe={class:"text-2xl font-bold text-yellow-600"},Ge={class:"bg-purple-50 p-4 rounded-lg"},We={class:"text-2xl font-bold text-purple-600"},Be={class:"card overflow-hidden"},He={class:"overflow-x-auto"},Re={class:"min-w-full divide-y divide-gray-200"},Qe={class:"bg-white divide-y divide-gray-200"},Je={class:"px-6 py-4 whitespace-nowrap text-sm text-gray-900"},Ye={class:"px-6 py-4 whitespace-nowrap"},Xe={class:"text-sm font-medium text-gray-900"},Ke={class:"text-sm text-gray-500"},ts={class:"px-6 py-4 whitespace-nowrap text-sm text-gray-900"},es={class:"px-6 py-4 whitespace-nowrap"},ss={class:"text-sm font-medium text-gray-900"},os={key:0,class:"text-xs text-blue-600"},ls={class:"px-6 py-4 whitespace-nowrap text-sm text-gray-900"},as={class:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900"},ns={class:"px-6 py-4 whitespace-nowrap"},rs={class:"px-6 py-4 whitespace-nowrap text-sm font-medium space-x-2"},is=["onClick"],ds=["onClick"],cs=["onClick"],us={key:0,class:"px-6 py-3 border-t border-gray-200 flex items-center justify-between"},ms={class:"text-sm text-gray-700"},xs={class:"flex space-x-2"},ps=["disabled"],gs=["disabled"],vs={key:0,class:"text-center py-12"},bs={key:1,class:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4"},ys={class:"bg-white rounded-lg max-w-2xl w-full max-h-[90vh] overflow-y-auto"},fs={class:"p-6"},_s={class:"flex items-center justify-between mb-4"},hs={key:0,class:"space-y-4"},ws={class:"grid grid-cols-2 gap-4"},ks={class:"text-sm text-gray-900"},$s={class:"grid grid-cols-2 gap-4"},Cs={class:"text-sm text-gray-900"},Ps={class:"text-xs text-gray-500"},Vs={class:"text-sm text-gray-900"},Es={class:"text-xs text-gray-500"},Ds={class:"text-sm text-gray-900"},Ns={class:"text-xs text-gray-500"},As={key:0},Ms={class:"text-sm text-gray-900"},js={class:"grid grid-cols-2 gap-4"},Is={class:"text-sm text-gray-900"},Os={class:"text-lg font-bold text-green-600"},Ts={class:"grid grid-cols-2 gap-4"},Ss={class:"text-sm text-gray-900"},zs={key:0},Ls={class:"text-sm text-gray-900"},O=20,Us={__name:"OrderManagement",setup(T){const x=U(),_=h(""),v=h(""),b=h(1),c=h(!1),i=h(null),e=h(!1),a=P(()=>{let u=[...x.pedidos];return _.value&&(u=u.filter(s=>s.estado===_.value)),v.value&&(u=u.filter(s=>s.vendedor_id===v.value)),u.sort((s,k)=>new Date(k.fecha)-new Date(s.fecha))}),w=P(()=>{const u=(b.value-1)*O,s=u+O;return a.value.slice(u,s)}),C=P(()=>Math.ceil(a.value.length/O)),j=P(()=>a.value.filter(u=>u.estado==="COMPLETADO").length),f=P(()=>a.value.filter(u=>u.estado==="PENDIENTE").length),d=P(()=>a.value.filter(u=>u.estado==="COMPLETADO").reduce((u,s)=>u+s.total,0)),g=u=>u?new Date(u).toLocaleDateString("es-CO",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"}):"N/A",o=u=>typeof u!="number"?"$0":u.toLocaleString("es-CO",{style:"currency",currency:"COP",minimumFractionDigits:0,maximumFractionDigits:0}),m=u=>{switch(u){case"COMPLETADO":return"bg-green-100 text-green-800";case"PENDIENTE":return"bg-yellow-100 text-yellow-800";case"CANCELADO":return"bg-red-100 text-red-800";default:return"bg-gray-100 text-gray-800"}},N=u=>{switch(u){case"COMPLETADO":return"Completado";case"PENDIENTE":return"Pendiente";case"CANCELADO":return"Cancelado";default:return u||"Desconocido"}},I=async(u,s)=>{try{e.value=!0;const{error:k}=await A.from("pedidos").update({estado:s}).eq("id",u.id);if(k)throw k;await x.loadPedidos(),window.showNotification("Estado actualizado",`Pedido marcado como ${N(s).toLowerCase()}`)}catch(k){console.error("Error actualizando estado:",k),window.showError("Error al actualizar estado",k.message)}finally{e.value=!1}},S=u=>{i.value=u,c.value=!0};return(u,s)=>{var k,F,Z,q,G;return r(),n("div",je,[t("div",Ie,[s[7]||(s[7]=t("h3",{class:"text-2xl font-bold text-gray-900"},"GestiÃ³n de Pedidos",-1)),t("div",Oe,[$(t("select",{"onUpdate:modelValue":s[0]||(s[0]=p=>_.value=p),class:"select-field"},[...s[5]||(s[5]=[t("option",{value:""},"Todos los estados",-1),t("option",{value:"PENDIENTE"},"Pendientes",-1),t("option",{value:"COMPLETADO"},"Completados",-1),t("option",{value:"CANCELADO"},"Cancelados",-1)])],512),[[J,_.value]]),$(t("select",{"onUpdate:modelValue":s[1]||(s[1]=p=>v.value=p),class:"select-field"},[s[6]||(s[6]=t("option",{value:""},"Todos los vendedores",-1)),(r(!0),n(E,null,D(V(x).vendedores,p=>(r(),n("option",{key:p.id,value:p.id},l(p.nombre),9,Te))),128))],512),[[J,v.value]])])]),t("div",Se,[t("div",ze,[t("div",Le,l(a.value.length),1),s[8]||(s[8]=t("div",{class:"text-blue-800 text-sm"},"Total Pedidos",-1))]),t("div",Ue,[t("div",Fe,l(j.value),1),s[9]||(s[9]=t("div",{class:"text-green-800 text-sm"},"Completados",-1))]),t("div",Ze,[t("div",qe,l(f.value),1),s[10]||(s[10]=t("div",{class:"text-yellow-800 text-sm"},"Pendientes",-1))]),t("div",Ge,[t("div",We,l(o(d.value)),1),s[11]||(s[11]=t("div",{class:"text-purple-800 text-sm"},"Ingresos",-1))])]),t("div",Be,[t("div",He,[t("table",Re,[s[12]||(s[12]=t("thead",{class:"bg-gray-50"},[t("tr",null,[t("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Fecha "),t("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Cliente "),t("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Vendedor "),t("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Producto "),t("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Cantidad "),t("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Total "),t("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Estado "),t("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Acciones ")])],-1)),t("tbody",Qe,[(r(!0),n(E,null,D(w.value,p=>{var W,B,H,R;return r(),n("tr",{key:p.id,class:"hover:bg-gray-50"},[t("td",Je,l(g(p.fecha)),1),t("td",Ye,[t("div",Xe,l(((W=p.cliente)==null?void 0:W.nombre)||"Cliente eliminado"),1),t("div",Ke,l(((B=p.cliente)==null?void 0:B.celular)||""),1)]),t("td",ts,l(((H=p.vendedor)==null?void 0:H.nombre)||"Vendedor eliminado"),1),t("td",es,[t("div",ss,l(((R=p.producto)==null?void 0:R.nombre)||"Producto eliminado"),1),p.nombres_personalizados?(r(),n("div",os,l(p.nombres_personalizados),1)):y("",!0)]),t("td",ls,l(p.cantidad),1),t("td",as,l(o(p.total)),1),t("td",ns,[t("span",{class:L([m(p.estado),"px-2 py-1 text-xs font-medium rounded-full"])},l(N(p.estado)),3)]),t("td",rs,[p.estado==="PENDIENTE"?(r(),n("button",{key:0,onClick:Q=>I(p,"COMPLETADO"),class:"text-green-600 hover:text-green-900",title:"Marcar como completado"}," âœ… ",8,is)):y("",!0),p.estado==="PENDIENTE"?(r(),n("button",{key:1,onClick:Q=>I(p,"CANCELADO"),class:"text-red-600 hover:text-red-900",title:"Cancelar pedido"}," âŒ ",8,ds)):y("",!0),t("button",{onClick:Q=>S(p),class:"text-blue-600 hover:text-blue-900",title:"Ver detalles"}," ðŸ‘ï¸ ",8,cs)])])}),128))])])]),C.value>1?(r(),n("div",us,[t("div",ms," Mostrando "+l((b.value-1)*O+1)+" a "+l(Math.min(b.value*O,a.value.length))+" de "+l(a.value.length)+" pedidos ",1),t("div",xs,[t("button",{onClick:s[2]||(s[2]=p=>b.value--),disabled:b.value===1,class:"px-3 py-1 text-sm bg-gray-100 text-gray-700 rounded disabled:opacity-50"}," Anterior ",8,ps),t("button",{onClick:s[3]||(s[3]=p=>b.value++),disabled:b.value===C.value,class:"px-3 py-1 text-sm bg-gray-100 text-gray-700 rounded disabled:opacity-50"}," Siguiente ",8,gs)])])):y("",!0)]),a.value.length===0?(r(),n("div",vs,[...s[13]||(s[13]=[t("div",{class:"text-gray-400 text-6xl mb-4"},"ðŸ›’",-1),t("p",{class:"text-gray-500 text-lg"},"No hay pedidos que coincidan con los filtros",-1)])])):y("",!0),c.value?(r(),n("div",bs,[t("div",ys,[t("div",fs,[t("div",_s,[s[14]||(s[14]=t("h4",{class:"text-xl font-semibold"},"Detalles del Pedido",-1)),t("button",{onClick:s[4]||(s[4]=p=>c.value=!1),class:"text-gray-400 hover:text-gray-600"}," âœ• ")]),i.value?(r(),n("div",hs,[t("div",ws,[t("div",null,[s[15]||(s[15]=t("label",{class:"block text-sm font-medium text-gray-700"},"Fecha",-1)),t("p",ks,l(g(i.value.fecha)),1)]),t("div",null,[s[16]||(s[16]=t("label",{class:"block text-sm font-medium text-gray-700"},"Estado",-1)),t("span",{class:L([m(i.value.estado),"px-2 py-1 text-xs font-medium rounded-full"])},l(N(i.value.estado)),3)])]),t("div",$s,[t("div",null,[s[17]||(s[17]=t("label",{class:"block text-sm font-medium text-gray-700"},"Cliente",-1)),t("p",Cs,l(((k=i.value.cliente)==null?void 0:k.nombre)||"N/A"),1),t("p",Ps,l(((F=i.value.cliente)==null?void 0:F.celular)||""),1)]),t("div",null,[s[18]||(s[18]=t("label",{class:"block text-sm font-medium text-gray-700"},"Vendedor",-1)),t("p",Vs,l(((Z=i.value.vendedor)==null?void 0:Z.nombre)||"N/A"),1),t("p",Es,l(((q=i.value.vendedor)==null?void 0:q.email)||""),1)])]),t("div",null,[s[19]||(s[19]=t("label",{class:"block text-sm font-medium text-gray-700"},"Producto",-1)),t("p",Ds,l(((G=i.value.producto)==null?void 0:G.nombre)||"N/A"),1),t("p",Ns,"Cantidad: "+l(i.value.cantidad),1)]),i.value.nombres_personalizados?(r(),n("div",As,[s[20]||(s[20]=t("label",{class:"block text-sm font-medium text-gray-700"},"Nombres Personalizados",-1)),t("p",Ms,l(i.value.nombres_personalizados),1)])):y("",!0),t("div",js,[t("div",null,[s[21]||(s[21]=t("label",{class:"block text-sm font-medium text-gray-700"},"Precio Unitario",-1)),t("p",Is,l(o(i.value.precio_unitario)),1)]),t("div",null,[s[22]||(s[22]=t("label",{class:"block text-sm font-medium text-gray-700"},"Total",-1)),t("p",Os,l(o(i.value.total)),1)])]),t("div",Ts,[t("div",null,[s[23]||(s[23]=t("label",{class:"block text-sm font-medium text-gray-700"},"Medio de Pago",-1)),t("p",Ss,l(i.value.medio_pago||"N/A"),1)]),i.value.monto_abono?(r(),n("div",zs,[s[24]||(s[24]=t("label",{class:"block text-sm font-medium text-gray-700"},"Monto Abono",-1)),t("p",Ls,l(o(i.value.monto_abono)),1)])):y("",!0)])])):y("",!0)])])])):y("",!0)])}}},Fs={class:"space-y-8"},Zs={class:"bg-white rounded-lg shadow-sm"},qs={class:"border-b border-gray-200"},Gs={class:"-mb-px flex space-x-8 px-6"},Ws=["onClick"],Bs={class:"p-6"},Hs={key:0,class:"space-y-6"},Rs={key:1,class:"space-y-6"},Qs={key:2,class:"space-y-6"},Js={key:3,class:"space-y-6"},to={__name:"AdminView",setup(T){const x=h("dashboard"),_=[{id:"dashboard",label:"ðŸ“Š Dashboard"},{id:"productos",label:"ðŸ“¦ Productos"},{id:"vendedores",label:"ðŸ‘¥ Vendedores"},{id:"pedidos",label:"ðŸ›’ Pedidos"}];return(v,b)=>(r(),n("div",Fs,[b[0]||(b[0]=t("div",{class:"text-center"},[t("h2",{class:"text-3xl font-bold text-gray-900 mb-2"},"Panel de AdministraciÃ³n"),t("p",{class:"text-gray-600"},"Gestiona productos, vendedores y visualiza estadÃ­sticas")],-1)),t("div",Zs,[t("div",qs,[t("nav",Gs,[(r(),n(E,null,D(_,c=>t("button",{key:c.id,onClick:i=>x.value=c.id,class:L(["py-4 px-1 border-b-2 font-medium text-sm transition-colors duration-200",x.value===c.id?"border-primary-500 text-primary-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"])},l(c.label),11,Ws)),64))])]),t("div",Bs,[x.value==="dashboard"?(r(),n("div",Hs,[z(zt)])):y("",!0),x.value==="productos"?(r(),n("div",Rs,[z(ie)])):y("",!0),x.value==="vendedores"?(r(),n("div",Qs,[z(Me)])):y("",!0),x.value==="pedidos"?(r(),n("div",Js,[z(Us)])):y("",!0)])])]))}};export{to as default};
